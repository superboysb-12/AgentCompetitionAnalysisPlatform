# Chinaiol 网站爬虫配置
# 点击文章链接并爬取跳转后的页面内容

tasks:
  - name: "chinaiol"
    mode: "indirect"
    start_url: "http://www.chinaiol.com/News/Channel/18.html"

    browser:
      timeout: 240 # 页面加载超时4分钟，处理多次跳转
      js_wait_time: 3 # JavaScript等待3秒（优化后）
      fast_js_wait_time: 1 # 快速模式下JS等待时间
      max_retries: 5 # 增加重试次数，应对不稳定的网络
      wait_for_navigation: true # 等待页面导航完成
      handle_popups: true # 处理弹窗

      # 新增性能优化配置
      fast_mode: true # 启用快速等待模式（适用于已加载的新标签页）
      wait_for_networkidle: false # 不等待网络空闲，加快速度
      check_content_stability: false # 禁用内容稳定性检测，已加载页面不需要
      network_timeout: 10000 # 网络超时10秒
      network_wait_attempts: 2 # 网络等待重试次数
      stability_check_interval: 1 # 内容稳定性检查间隔1秒

    button_discovery:
      selectors:
        # 优化后的选择器 - 更简洁且通用
        - "h3 a[href*='Details']" # 匹配文章标题链接
        - ".m0 h3 a" # 备用选择器
        - "#channelContent h3 a" # 内容区域的标题链接
      max_buttons: 10 # 增加数量限制
      deduplicate: true # 启用智能去重
      smart_discovery: true # 启用智能发现，避免选择器重叠

    content_extraction:
      # 文章标题 - 简化选择器
      title: "h1.rich_media_title, h1.title, .rich_media_title, h1, .article-title, .post-title"

      # 文章正文内容 - 优化选择器，覆盖更多场景
      content: "#js_content p, .islock p, .article-content, .post-content, .content, article p, main p"

      # 文章作者
      author: ".author, .writer, .byline, .post-author"

      # 发布时间
      publish_date: ".publish-date, .post-date, .date, time, .timestamp"

      # 文章摘要
      summary: ".summary, .excerpt, .description, .intro"

      # 标签分类
      tags: ".tags, .tag, .category, .post-tags"

      # 文章图片
      images: "img[src], .article-image img, .content img, .post-image img, #js_content img"

      # 链接信息
      links: "a[href], .content a, .article-content a"

      # 页面所有文本内容（兜底方案）
      all_text: "p, div, span, h1, h2, h3, h4, h5, h6, article, main, section"

settings:
  browser_type: "chromium"
  headless: false # 保持可见，便于观察多次跳转过程
  output_dir: "results"
  storage_type: "json"
  global_timeout: 300 # 优化全局超时到5分钟

  # 多跳转处理配置
  multi_hop:
    enable: true
    max_hops: 3 # 减少跳转次数
    wait_between_hops: 2 # 减少跳转间等待时间

  # 新标签页处理
  tab_handling:
    auto_switch: true # 自动切换到新标签页
    close_previous: false # 保留之前的标签页用于返回
    wait_for_load: true # 等待新页面完全加载
